- content_for :content  do
  - if @page.occurrence_map?
    - content_for :head do
      - prefix = @page.id.to_i % 100
      = javascript_include_tag "http://maps.google.com/maps/api/js?key=#{Rails.application.secrets.google_maps_key}"
      = javascript_include_tag "maps_vendored"
      = javascript_include_tag "http://media.eol.org/content/maps/#{prefix}/#{@page.id}.json"
      = javascript_include_tag "maps"
  - is_cover_page = current_page?(page_cover_path(page_id: @page.id)) || current_page?(page_path(@page))
  #name-header.toggle.uk-section{ hidden: is_cover_page, uk: { grid: true } }
    -# NOTE: this is largely duplicated in _cover.html.haml ; not worth extracting.
    #names.page-names.uk-width-2-3
      - if @page.name == @page.scientific_name
        %h1.uk-margin-small-bottom= @page.name.html_safe
      - else
        %h1.uk-margin-small-bottom= @page.name.titlecase.html_safe
        %h3.uk-margin-remove-top.uk-text-muted= @page.scientific_name.html_safe
    .uk-width-1-3
      -# TODO: remote...
      - basic_button("plus", t("pages.actions.collect"), new_collected_page_path(page_id: @page.id))
      - if is_admin?
        - basic_button("refresh", t("pages.actions.reindex"), page_reindex_path(@page), remote: true, data: { disable_with: "" }, class: "ui disable-on-click")
  #page
    .uk-margin-top
      %ul#page_nav.uk-tab.uk-child-width-expand
        - tab(name: "cover", icon: "unhide", count: nil, path: page_cover_path(page_id: @page.id), active: is_cover_page)
        - if @page.media_count > 0
          - tab(name: "media", icon: "image", count: @page.media_count, path: page_media_path(page_id: @page.id))
        - unless @page.traits.empty?
          - tab(name: "traits", icon: "bar chart", count: @page.traits_count, path: page_traits_path(page_id: @page.id))
        - if @page.map?
          -# TODO: We want to use @page.maps_count here, eventually. ...but we don't SHOW those maps yet...
          - tab(name: "maps", icon: "world", count: @page.map_count, path: page_maps_path(page_id: @page.id))
        - if @page.articles.size > 0
          - tab(name: "details", icon: "info", count: @page.articles_count, path: page_details_path(page_id: @page.id))
        - tab(name: "classifications", icon: "sitemap", count: @page.nodes_count, path: page_classifications_path(page_id: @page.id))
        - tab(name: "names", icon: "tags", count: @page.names_count, path: page_names_path(page_id: @page.id))
        - if @page.literature_and_references_count > 1
          - tab(name: "literature_and_references", icon: "book", count: @page.literature_and_references_count, path: page_literature_and_references_path(page_id: @page.id))
      #tab_content
        .ui.inverted.dimmer
          .ui.loader
        #page_nav_content
          = content_for?(:nav_content) ? yield(:nav_content) : yield
= render template: "layouts/application"
